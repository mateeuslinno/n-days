`Vulnerability` : OOB 
`Patched In` : iOS 15.4 / macOS 12.3.1  
`Location` : AppleAVD.kext  
`Discovered By` : [Mickey Jin](https://twitter.com/patch1t)
`CVE ID` : [CVE-2022-22675](https://support.apple.com/en-us/HT213219)  
`Author` : [mateeuslinno](https://twitter.com/mateeuslinno)  




```
com.apple.driver.AppleAVD:__text:FFFFFE000830BC84                 STP             X26, X25, [SP,#-0x10+var_40]!
com.apple.driver.AppleAVD:__text:FFFFFE000830BC88                 STP             X24, X23, [SP,#0x40+var_30]
com.apple.driver.AppleAVD:__text:FFFFFE000830BC8C                 STP             X22, X21, [SP,#0x40+var_20]
com.apple.driver.AppleAVD:__text:FFFFFE000830BC90                 STP             X20, X19, [SP,#0x40+var_10]
com.apple.driver.AppleAVD:__text:FFFFFE000830BC94                 STP             X29, X30, [SP,#0x40+var_s0]
com.apple.driver.AppleAVD:__text:FFFFFE000830BC98                 ADD             X29, SP, #0x40
com.apple.driver.AppleAVD:__text:FFFFFE000830BC9C                 MOV             X19, X1
com.apple.driver.AppleAVD:__text:FFFFFE000830BCA0                 MOV             X20, X0
com.apple.driver.AppleAVD:__text:FFFFFE000830BCA4                 LDR             W8, [X0,#0xC]
com.apple.driver.AppleAVD:__text:FFFFFE000830BCA8                 CLZ             W21, W8
com.apple.driver.AppleAVD:__text:FFFFFE000830BCAC                 CBZ             W21, loc_FFFFFE000830BCF0
com.apple.driver.AppleAVD:__text:FFFFFE000830BCB0                 ADD             W1, W21, #1 ; int
com.apple.driver.AppleAVD:__text:FFFFFE000830BCB4                 MOV             X0, X20 ; this
com.apple.driver.AppleAVD:__text:FFFFFE000830BCB8                 MOV             W2, #0  ; bool
com.apple.driver.AppleAVD:__text:FFFFFE000830BCBC                 BL              __ZN8AVC_RBSP10flush_bitsEib ; AVC_RBSP::flush_bits(int,bool)
com.apple.driver.AppleAVD:__text:FFFFFE000830BCC0                 LDR             W8, [X20,#0xC]
com.apple.driver.AppleAVD:__text:FFFFFE000830BCC4                 NEG             W9, W21
com.apple.driver.AppleAVD:__text:FFFFFE000830BCC8                 LSR             W22, W8, W9
com.apple.driver.AppleAVD:__text:FFFFFE000830BCCC                 MOV             X0, X20 ; this
com.apple.driver.AppleAVD:__text:FFFFFE000830BCD0                 MOV             X1, X21 ; int
com.apple.driver.AppleAVD:__text:FFFFFE000830BCD4                 MOV             W2, #0  ; bool
com.apple.driver.AppleAVD:__text:FFFFFE000830BCD8                 BL              __ZN8AVC_RBSP10flush_bitsEib ; AVC_RBSP::flush_bits(int,bool)
com.apple.driver.AppleAVD:__text:FFFFFE000830BCDC                 MOV             W8, #0xFFFFFFFF
com.apple.driver.AppleAVD:__text:FFFFFE000830BCE0                 LSL             W8, W8, W21
com.apple.driver.AppleAVD:__text:FFFFFE000830BCE4                 MVN             W8, W8
com.apple.driver.AppleAVD:__text:FFFFFE000830BCE8                 ADD             W8, W22, W8
com.apple.driver.AppleAVD:__text:FFFFFE000830BCEC                 B               loc_FFFFFE000830BD04
```
